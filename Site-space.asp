
<title>空间查看</title>
<style type="text/css">
table {  font-size: 9pt}
BODY { FONT-FAMILY: 宋体; FONT-SIZE: 9pt;
SCROLLBAR-HIGHLIGHT-COLOR: buttonface;
SCROLLBAR-SHADOW-COLOR: buttonface;
SCROLLBAR-3DLIGHT-COLOR: buttonhighlight;
SCROLLBAR-TRACK-COLOR: #eeeeee;
SCROLLBAR-DARKSHADOW-COLOR: buttonshadow}
a{text-decoration: none;} /* 链接无下划线,有为underline */ 
a:link {color: #CDE7CD;} /* 未访问的链接 */
a:visited {color: #CDE7CD;} /* 已访问的链接 */
a:hover{color: #FFCC00;} /* 鼠标在链接上 */ 
a:active {color: #FFCC00;} /* 点击激活链接 */
.nav_l2{text-decoration:none;font-size:14px;color:#0099CC;height:0;filter:dropshadow(offX=1,offY=1,color=002E5B);}
A.nav_l2:link{text-decoration:none;font-size:14px;color:#0099CC;height:0;filter:dropshadow(offX=1,offY=1,color=002E5B);}
A.nav_l2:visited{text-decoration:none;font-size:14px;color:#FFFFFF;height:0;filter:dropshadow(offX=1,offY=1,color=002E5B);}
A.nav_l2:active{text-decoration:underline;font-size:14px;color:#fff;height:0;filter:dropshadow(offX=1,offY=1,color=#00FF33);}
A.nav_l2:hover{text-decoration:underline;font-size:14px;color:#fff;height:0;filter:dropshadow(offX=1,offY=1,color=#FF9900);}
body{
    FONT-FAMILY: "新宋体";
    FONT-SIZE: 12px;
    text-decoration: none;
    line-height: 150%;
    background:#0B8290;
    SCROLLBAR-FACE-COLOR: #016E7B;
    SCROLLBAR-HIGHLIGHT-COLOR: #013D44;
    SCROLLBAR-SHADOW-COLOR: #70A9E9;
    SCROLLBAR-3DLIGHT-COLOR: #70A9E9;
    SCROLLBAR-ARROW-COLOR: #013D44;
    SCROLLBAR-TRACK-COLOR: #01383E;
    SCROLLBAR-DARKSHADOW-COLOR: #01383E;
    padding:0px;
    margin-top: 0px;
    margin-right: 0px;
    margin-bottom: 0px;
    margin-left: 0px;
}
 /* 表单类 */
Button,input,textarea{
    FONT-FAMILY: "宋体";
    FONT-SIZE: 12px;
	COLOR:#F3F3F3;
    text-decoration: none;
    line-height: 150%;
   background:#037987;
	border-top-width: 1px;
	border-right-width: 1px;
	border-bottom-width: 1px;
	border-left-width: 1px;
   /* border-top-style: dotted;
	border-right-style: dotted;
	border-bottom-style: dotted;
	border-left-style: dotted;
	border-top-color: #013036;
	border-right-color: #013036;
	border-bottom-color: #013036;
	border-left-color: #013036;*/
	padding:0px;
    margin-top: 0px;
    margin-right: 0px;
    margin-bottom: 0px;
    margin-left: 0px;
}
 /* 下拉菜单 */
select{
    font-family: "宋体,新宋体,Verdana";
    font-size: 12px;
	color:#336666;
    text-decoration: none;
    line-height: 150%;
    /*background:#037987;*/
	border-top-width: 0px;
	border-right-width: 0px;
	border-bottom-width:0px;
	border-left-width: 0px;
	border-top-style: dotted;
	border-right-style: dotted;
	border-bottom-style: dotted;
	border-left-style: dotted;
	border-top-color: #038291;
	border-right-color: #038291;
	border-bottom-color: #038291;
	border-left-color: #038291;
	padding:0px;
    margin-top: 0px;
    margin-right: 0px;
    margin-bottom: 0px;
    margin-left: 0px;
}
.xk {
	border: 1px solid #01393F;
	margin-top: 5px;
	margin-bottom: 5px;
	background:#018A9B;
}
 /* 定义表CSS */
.table{
	border: 1px solid #013D44;
	margin-top: 5px;
	margin-bottom: 5px;
	background:#087579;
}
 /* 菜单部分定义表CSS  */
.leftframetable{
	border: 1px solid #01393F;
	margin-top: 3px;
	margin-bottom: 3px;
	background:#0B8290;
}
.bt {
	font-size: 12px;
	font-weight: bold;
	color: #EBEBEB;
	text-decoration: none;
}
td {
	color:#B6D8B6;
	font-size:12px;
    line-height: 18px;
}
 /* 定义大字体标题CSS  */
.xingmu {
	font-family: "Verdana, 新宋体";
	color:#B0D6B0;
	font-size:12px;
	font-weight:bolder;
	background:#014952;
    line-height: 22px;
}
.titledaohang {
	FONT-SIZE: 12px; 
	FILTER: Glow(Color=#024361, Strength=2) dropshadow(Color=#024361, OffX=1, OffY=1,); 
	COLOR: #B0D6B0; 
	font-weight:bolder;
	FONT-FAMILY: '宋体'
}
A.admintx:link {
	FONT-WEIGHT: normal; FONT-SIZE: 12px; COLOR: #B0D6B0; TEXT-DECORATION: none;font-weight:bolder;
}
A.admintx:visited {
	FONT-WEIGHT: normal; FONT-SIZE: 12px; COLOR: #B0D6B0; TEXT-DECORATION: none;font-weight:bolder;
}
A.admintx:hover {
	FONT-WEIGHT: normal; FONT-SIZE: 12px; COLOR: #023389; TEXT-DECORATION: none;font-weight:bolder;
}
A.admintx:active {
	FONT-WEIGHT: normal; FONT-SIZE: 12px; COLOR: #023389; TEXT-DECORATION: none;font-weight:bolder;
}

.back {
	background:#016470;
}
.Leftback {
	background:#017280;
}
.hback {
	background:#097B88;
}
.hback_1 {
	background:#0A8A98;
}
 /* 框架CSS  */
.bordercolor {
cursor:col-resize;
border-left:none;
border-bottom:none;
border-top:none;
border-right:solid;
border-right-width:3px;
border-right-color:#0B8290;
}
 /* 大字体CSS  */
.pagetile {
	font-weight:bolder;
	font-size:20px;
}
.ischeck
{
	color:#FF9900;
}
/*自定义CSS样式一，黄色*/
a.CusCss1.link
{
	color:#FFFFFF;
}
/*自定义CSS样式二,黄蓝*/
.CusCss2
{
	color:#00CCCC;
}
/*自定义CSS样式二,黄白*/
.CusCss3
{
	color:#FFCCCC;
}
.alps {
FONT-SIZE: 9pt; 
FILTER: Glow(Color=#0F42A6, Strength=2) dropshadow(Color=#0F42A6, OffX=2, OffY=1,); 
COLOR: #8AADE9; 
FONT-FAMILY: '宋体'
}
A.top:link {
	FONT-WEIGHT: normal; FONT-SIZE: 12px; COLOR: #B0D6B0; TEXT-DECORATION: none
}
A.top:visited {
	FONT-WEIGHT: normal; FONT-SIZE: 12px; COLOR: #B0D6B0; TEXT-DECORATION: none
}
A.top:hover {
	FONT-WEIGHT: normal; FONT-SIZE: 12px; COLOR: #FF9900; TEXT-DECORATION: none
}
A.top:active {
	FONT-WEIGHT: normal; FONT-SIZE: 12px; COLOR: #FF9900; TEXT-DECORATION: none
}
A.otherset:link {
	FONT-WEIGHT: normal; FONT-SIZE: 12px; COLOR: #B0D6B0; TEXT-DECORATION: none
}
A.otherset:visited {
	FONT-WEIGHT: normal; FONT-SIZE: 12px; COLOR: #B0D6B0; TEXT-DECORATION: none
}
A.otherset:hover {
	FONT-WEIGHT: normal; FONT-SIZE: 12px; COLOR: #FF0000; TEXT-DECORATION: none
}
A.otherset:active {
	FONT-WEIGHT: normal; FONT-SIZE: 12px; COLOR: #FF0000; TEXT-DECORATION: none
}
.tx
{
Color:B0FF9D;
}
A.sd:link {
	FONT-WEIGHT: normal; FONT-SIZE: 12px; COLOR: #CDE7CD; TEXT-DECORATION: none
}
A.sd:visited {
	FONT-WEIGHT: normal; FONT-SIZE: 12px; COLOR: #CDE7CD; TEXT-DECORATION: none
}
A.sd:hover {
	FONT-WEIGHT: normal; FONT-SIZE: 12px; COLOR: #FCDE11; TEXT-DECORATION: none
}
A.sd:active {
	FONT-WEIGHT: normal; FONT-SIZE: 12px; COLOR: #FCDE11; TEXT-DECORATION: none
}
.RightInput{
	font-size:12px
	border-bottom:solid;
	border-bottom-color:#FFFFFF;
	border-bottom-width:1;
	border-left:solid;
	border-left-color:#FFFFFF;
	border-left-width:1;
	border-right:solid;
	border-right-color:#FFFFFF;
	border-right-width:1;
	border-top:solid;
	border-top-color:#FFFFF;
	border-top-width:1;
}
.WarnInput{
	font-size:12px
	border-bottom:solid;
	border-bottom-color:#FF0000;
	border-bottom-width:1;
	border-left:solid;
	border-left-color:#FF0000;
	border-left-width:1;
	border-right:solid;
	border-right-color:#FF0000;
	border-right-width:1;
	border-top:solid;
	border-top-color:#FF0000;
	border-top-width:1;
	
}
.Font12_lan {font-size:12px;color:#0099CC;}
.Input_Bg {
width:98%; height:18px;
/*background-image:url(../../../images/bg.gif); */
background-color: #778EC2;
color:#ffffff;
font-family: Georgia, "Times New Roman", Times, serif;
}
</STYLE>
<meta NAME=GENERATOR CHARSET=GB2312>
<BODY BGCOLOR=#ffffff topmargin="20">
  <table width="95%" height="132" border="0" align="center" cellpadding="5" cellspacing="1" class="table">
    <tr class="hback"> <td> 
<table cellpadding=0 cellspacing=1 border=0 width=100%> 
  <tr bgcolor='#EEEEEE'> 
<td height="25" colspan="2" align=center class="xingmu">空间使用情况 </td>
</tr> <tr > <td width="80%" valign=top> 
<% 	
 	Sub ShowSpaceInfo(drvpath)
 		dim fso,d,size,showsize
 		set fso=server.createobject("scripting.filesystemobject") 		
 		drvpath=server.mappath(drvpath) 		 		
 		set d=fso.getfolder(drvpath) 		
 		size=d.size
 		showsize=size & "&nbsp;Byte" 
 		if size>1024 then
 		   size=(size\1024)
 		   showsize=size & "&nbsp;KB"
 		end if
 		if size>1024 then
 		   size=(size/1024)
 		   showsize=size & "&nbsp;MB"		
 		end if
 		if size>1024 then
 		   size=(size/1024)
 		   showsize=size & "&nbsp;GB"	   
 		end if   
 		response.write "<font face=verdana>" & showsize & "</font>"
 	End Sub	
 	
 	Sub Showspecialspaceinfo(method)
 		dim fso,d,fc,f1,size,showsize,drvpath 		
 		set fso=server.createobject("scripting.filesystemobject")
 		drvpath=server.mappath("pic")
 		drvpath=left(drvpath,(instrrev(drvpath,"\")-1))
 		set d=fso.getfolder(drvpath) 		
 		
 		if method="All" then 		
 			size=d.size
 		elseif method="Program" then
 			set fc=d.Files
 			for each f1 in fc
 				size=size+f1.size
 			next	
 		end if	
 		
 		showsize=size & "&nbsp;Byte" 
 		if size>1024 then
 		   size=(size\1024)
 		   showsize=size & "&nbsp;KB"
 		end if
 		if size>1024 then
 		   size=(size/1024)
 		   showsize=size & "&nbsp;MB"		
 		end if
 		if size>1024 then
 		   size=(size/1024)
 		   showsize=size & "&nbsp;GB"	   
 		end if   
 		response.write "<font face=verdana>" & showsize & "</font>"
 	end sub 	 	 	
 	
 	Function Drawbar(drvpath)
 		dim fso,drvpathroot,d,size,totalsize,barsize
 		set fso=server.createobject("scripting.filesystemobject")
 		drvpathroot=server.mappath("pic")
 		drvpathroot=left(drvpathroot,(instrrev(drvpathroot,"\")-1))
 		set d=fso.getfolder(drvpathroot)
 		totalsize=d.size
 		
 		drvpath=server.mappath(drvpath) 		
 		set d=fso.getfolder(drvpath)
 		size=d.size
 		
 		barsize=cint((size/totalsize)*400)
 		Drawbar=barsize
 	End Function 	
 	
 	Function Drawspecialbar()
 		dim fso,drvpathroot,d,fc,f1,size,totalsize,barsize
 		set fso=server.createobject("scripting.filesystemobject")
 		drvpathroot=server.mappath("pic")
 		drvpathroot=left(drvpathroot,(instrrev(drvpathroot,"\")-1))
 		set d=fso.getfolder(drvpathroot)
 		totalsize=d.size
 		
 		set fc=d.files
 		for each f1 in fc
 			size=size+f1.size
 		next	
 		
 		barsize=cint((size/totalsize)*400)
 		Drawspecialbar=barsize
 	End Function 	
 %> 
 <table width=100% cellspacing=0 cellpadding=0 ALIGN="CENTER"> 
 <tr class="hback"> <td height=25 WIDTH="100%"> 
&nbsp;系统空间占用情况</td></tr> <tr class="hback"> <td WIDTH="100%"> 
	<blockquote> <%
 			fsorank=1
 			if fsorank=1 then
 			%> <br> <%Function GetPP
 				dim s
 				s=Request.ServerVariables("path_translated")
 				GetPP=left(s,instrrev(s,"\",len(s)))
 			End function
 			if sPP="" then sPP=GetPP
 			if right(sPP,1)<>"\" then sPP=sPP&"\"
 			set fso=server.createobject("scripting.filesystemobject")
 			Set f = fso.GetFolder(sPP)
 			Set fc = f.SubFolders
 			i=1
                        i2=1
 			For Each f in fc%> 目录<b><%=f.name%></b>占用空间：&nbsp;<img src="images/smallbg.gif" width=<%=drawbar(""&f.name&"")%> height=10>&nbsp;<%showSpaceinfo(""&f.name&"")%><br><br> 
<%i=i+1
                          if i2<10 then
 			    i2=i2+1
                          else
                            i2=1
                          end if
 					Next%> 根目录文件占用空间：&nbsp;<img src="images/smallbg.gif" width=<%=drawspecialbar%> height=10>&nbsp;<%showSpecialSpaceinfo("Program")%><br><br> 
系统占用空间总计：&nbsp;<img src="images/smallbg2.gif" width=400 height=10> <%showspecialspaceinfo("All")%> 
<%
 			else
 				response.write "<br><li>本功能已经被关闭"
 			end if
 			%> </blockquote></td></tr> </table></td></tr> </table>
